<link rel="import" href="/bower_components/polymer/polymer.html">

<style is="custom-style">
    :root #contentWrapper.iron-dropdown > .dropdown-content {
        overflow: hidden;
    }
</style>

<dom-module id="day-app">
    <style>
        paper-toolbar {
            z-index: 100;
        }
        .display-option-menu paper-button {
            text-transform: none;
            color: #45ada8;
        }
        .paneContainer {
            margin-top: 32px;
            padding-right: 15px;
            padding-left: 15px;
            margin-right: auto;
            margin-left: auto;

            display: flex;
            flex-wrap: wrap;
        }

        @media (min-width: 768px) {
            .paneContainer {
                width:750px
            }
        }

        @media (min-width: 992px) {
            .paneContainer {
                width:970px
            }
        }

        @media (min-width: 1200px) {
            .paneContainer {
                width:1170px
            }
        }
        .pane {
            padding-right: 24px;
            padding-bottom: 32px;
        }
        music-player {
            width: 250px;
        }
        weather-pane {
            flex-grow: 1;
            align-self: center;
        }
        calendar-pane {
            flex-grow: 1;
        }
        news-pane {
            flex-grow: 2;
        }
    </style>

    <template>
        <paper-header-panel mode="standard">
            <paper-toolbar>
                <paper-icon-button icon="home" on-click="goHome"></paper-icon-button>
                <paper-menu-button>
                    <paper-icon-button icon="dashboard" class="dropdown-trigger"></paper-icon-button>
                    <paper-menu class="dropdown-content display-option-menu">
                        <paper-item>
                            <paper-radio-button checked="{{displayOptions.showWeather}}">Weather</paper-radio-button>
                        </paper-item>
                        <paper-item>
                            <paper-radio-button checked="{{displayOptions.showCalendar}}">Calendar</paper-radio-button>
                        </paper-item>
                        <paper-item>
                            <paper-radio-button checked="{{displayOptions.showNews}}">News</paper-radio-button>
                        </paper-item>
                        <paper-item>
                            <paper-button on-click="resetDisplayOptions" class="error">Reset</paper-radio-button>
                        </paper-item>
                    </paper-menu>
                </paper-menu-button>
                <span class="title"></span>
                <music-player title="Rain" src="/cache/rain.mp3" play-list="{{playList}}"></music-player>
            </paper-toolbar>
            <div class="paneContainer">
                <weather-pane class="pane" hidden="[[!displayOptions.showWeather]]"></weather-pane>
                <calendar-pane class="pane" hidden="[[!displayOptions.showCalendar]]"></calendar-pane>
                <news-pane class="pane" hidden="[[!displayOptions.showNews]]"></news-pane>
            </div>
        </paper-header-panel>
    </template>

    <script>
        Polymer({
            is: "day-app",
            properties: {
                playList: {
                    type: Object,
                    notify: true,
                    value: function () {
                        return [
                            { title: "Original Rain Track", src: "/cache/rain.mp3" },
                            { title: "Rain on Street", src: "/cache/rain-street.mp3" },
                            { title: "Rain with Traffic", src: "/cache/rain-traffic.mp3" },
                            { title: "Rain by Window", src: "/cache/rain-window.mp3" },
                        ]
                    }
                }
            },
            observers: [
                'displayOptionsChanged(displayOptions.*)'
            ],
            ready: function() {
                this.message = "My first Polymer App!";

                var savedOptions = Cookies.get("DisplayOptions");
                if (typeof savedOptions == "string" && savedOptions.length > 0) {
                    this.displayOptions = JSON.parse(savedOptions);
                } else {
                    this.displayOptions = {
                        showWeather: true,
                        showCalendar: true,
                        showNews: true
                    };
                }
            },

            displayOptionsChanged: function () {
                Cookies.set("DisplayOptions", this.displayOptions, {
                    expires: 30
                });
            },

            resetDisplayOptions: function () {
                this.displayOptions = {
                    showWeather: true,
                    showCalendar: true,
                    showNews: true
                };
            },

            goHome: function() {
                window.location = "/";
            }
        });
    </script>
</dom-module>
