<link rel="import" href="/bower_components/polymer/polymer.html">

<dom-module id="calendar-pane">
    <template>
        <style>
            @font-face {
                font-family: 'SimSun';
                src: url('/Assets/Font/SimSun.ttf');
            }
            paper-card {
                width: 450px;
                height: 550px;
                border: 3px solid;
                font-family: 'SimSun';
            }
            .top-divider {
                width: 100%; 
                padding-top: 4px;
                border-bottom: 1px solid;
            }
            .card-content {
                padding: 0px;
            }
            .ganzhi-section {
                width: 48px;
                height: 308px;
                padding: 16px 16px 16px 18px;
                font-size: 18px;
                font-weight: 600;
                border-bottom: 1px solid;
            }
            .lunar-section {
                position: absolute;
                top: 0px;
                left: 48px;
                width: 44px;
                height: 308px;
                padding: 16px 16px 16px 8px;
                font-size: 18px;
                font-weight: 600;
                border-bottom: 1px solid;
            }
            .date-section {
                position: absolute;
                top: 0px;
                right: 0px;
                width: 352px;
                height: 48px;
                border-left: 1px solid;
                text-align: right;
                padding: 8px 16px;
                font-size: 24px;
                font-weight: 600;
            }
            .day-section {
                position: absolute;
                height: 352px;
                right: 0;
                top: 48px;
                width: 352px;
                text-align: center;
                font-size: 210px;
                border-left: 1px solid;
            }
        </style>

        <div>
            <paper-card>
                <div class="top-divider"></div>
                <div class="card-content">
                    <div class="ganzhi-section">
                        [[lunar.GanZhiYear]]年
                        [[lunar.zodiac]]年
                        [[lunar.GanZhiMonth]]月
                        [[lunar.GanZhiDay]]日
                    </div> 
                    <div class="lunar-section">
                        农历[[lunar.lunarMonthName]][[lunar.lunarDayName]]
                    </div>    
                    <div class="date-section">
                        [[date]]
                    </div>
                    <div class="day-section">
                        [[lunar.lunarDay]] 
                    </div>
                </div>
            </paper-card>
        </div>

        <iron-ajax
            id="getCalendar"
            url="/api/getLunarCalendar"
            method="GET"
            content-type="application/json"
            handle-as="json"
            on-response="calendarResponse"
            debounce-duration="300"></iron-ajax>

    </template>

    <script>
        Polymer({
            is: "calendar-pane",

            ready: function() {
                var _this = this;

                var _initialize = function() {
                    _this.$.getCalendar.generateRequest();
                }
                _initialize();
            },

            calendarResponse: function(e, data) {
                this.lunar = data.response;

                var week = ["周日", "周一", "周二", "周三", "周四", "周五", "周六"];
                var date = new Date(this.lunar.date)

                var year = date.getFullYear();
                var month = date.getMonth() + 1;
                var day = date.getDate();

                var month_pad = ("0" + month).slice(-2);
                var day_pad = ("0" + day).slice(-2);
                this.date = year + '.' + month_pad + '.' + day_pad + ' ' + week[date.getDay()];
            }
        });
    </script>
</dom-module>
